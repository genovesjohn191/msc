<div *ngIf="isInputVisible || isLoading" class="div-container">
  <mat-form-field
    *ngIf="visible && !isResourceSelfManaged"
    appearance="outline"
    [matBadge]="hasError ? '!' : ''"
    matBadgePosition="before"
    matBadgeColor="warn"
    matBadgeSize="small"
    [matTooltip]="hasError ? 'Failed to load options' : ''"
    matTooltipPosition="above"
    [hintLabel]="config.hint"
    class="gateway-ip-field">
    <mat-label [attr.for]="id" >{{ isLoading ? 'Loading...' : label }}</mat-label>

    <mat-select
      [mcsId]="id"
      [required]="required"
      [disabled]="disabled"
      [(value)]="config.value"
      (selectionChange)="valueChange($event); onSelectionChange($event);">
      <mat-option [value]="''">-- New Gateway IP --</mat-option>
      <mat-option *ngFor="let opt of config.options" [value]="opt.key">
        {{ opt.value }}
      </mat-option>
    </mat-select>

    <mat-spinner *ngIf="isLoading" class="spinner" diameter="20" matSuffix></mat-spinner>

    <button mat-icon-button matSuffix
      (click)="retrieveOptions()"
      *ngIf="hasError"
      matTooltip="Retry"
      matTooltipPosition="above">
      <mat-icon color="primary">refresh</mat-icon>
    </button>
  </mat-form-field>

  <mat-error *ngIf="hasError && isResourceSelfManaged">{{ inputError }}</mat-error>
  <mat-form-field
    *ngIf="visible && isResourceSelfManaged"
    appearance="outline"
    class="gateway-ip-field">
    <mat-label [attr.for]="id" >{{ label }}</mat-label>

    <input
      #control matInput type="text"
      [mcsId]="id"
      [required]="required"
      [disabled]="disabled"
      [placeholder]="config.placeholder"
      [(ngModel)]="control.value"
      (focusout)="focusOut(control.value)"
      (input)="valueChange($event)"/>

  </mat-form-field>
</div>

<span *ngIf="!(isInputVisible || isLoading)" class="span-text">
  A new subnet will be created for this network. 
</span>

<span class="divider"> / </span>

<div style="max-width: 100px; display: inline-block;">
  <mat-error *ngIf="prefixError">{{ prefixHint }}</mat-error>
  <mat-form-field
    *ngIf="visible"
    appearance="outline"
    style="max-width: 100px;">
    <mat-label [attr.for]="id"> Prefix Length </mat-label>
  
    <input matInput type="number" class="number"
      [mcsId]="prefix"
      [required]="config.prefixValidators?.required"
      [disabled]="prefixDisabled"
      [min]="config.prefixValidators?.min"
      [max]="config.prefixValidators?.max"
      (input)="valueChange($event)"
      [(ngModel)]="prefixLength"
      (change)="prefixChange()"/>
  </mat-form-field>
</div>