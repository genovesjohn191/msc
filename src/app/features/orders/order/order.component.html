<mcs-page [header]="'order.header' | translate:{orderId: (order$ | async)?.orderId}">
  <!-- Top Panel -->
  <mcs-top-panel *mcsTopPanelDef>

    <!-- Back to Orders -->
    <mcs-top-panel-item *mcsTopPanelItemDef>
      <mcs-action-item (click)="gotoOrders()"
        mcsId mcsAlign="end"
        mcsEventTracker="navigate-to-order-listing"
        mcsEventCategory="order"
        mcsEventLabel="order-details-page">
        <mcs-icon [key]="backIconKey" size="large"></mcs-icon>
        <span>{{ 'order.backToOrders' | translate }}</span>
      </mcs-action-item>
    </mcs-top-panel-item>
  </mcs-top-panel>

  <!-- Content Panel -->
  <mcs-content-panel *mcsContentPanelDef>

    <ng-container *ngIf="order$ | async as order">
      <!-- Order details -->
      <div class="limited-view">
        <mcs-presentation-panel>
          <ng-container mcsPresentationPanelHeader>
            <h2>{{ 'order.description' | translate }}</h2>
          </ng-container>

          <p>
            <strong [innerHTML]="order.description | mcsNewLines"></strong>
            <mcs-item>
              <button mcsButton color="error">Cancel</button>
              <button mcsButton>Approve</button>
            </mcs-item>
          </p>

          <mcs-item>
            <span>{{ 'order.contractDuration' | translate }}:</span>
            <span>12</span>
          </mcs-item>

          <mcs-item>
            <span>{{ 'order.status' | translate }}:</span>
            <span [innerHTML]="order.statusLabel | mcsDataLabel"></span>
          </mcs-item>

          <mcs-item>
            <span>{{ 'order.createdBy' | translate }}:</span>
            <span>{{ order.createdBy }}</span>
          </mcs-item>
        </mcs-presentation-panel>
      </div>

      <!-- Order Items -->
      <mcs-table [dataSource]="order.items" class="limited-view">
        <!-- Item ID Column -->
        <ng-container mcsColumnDef="id">
          <mcs-header-cell *mcsHeaderCellDef>
            {{ 'order.columnHeaders.id' | translate }}
          </mcs-header-cell>
          <mcs-data-cell *mcsDataCellDef="let row">
            {{ row.orderItemId }}
          </mcs-data-cell>
        </ng-container>

        <!-- Type Column -->
        <ng-container mcsColumnDef="type">
          <mcs-header-cell *mcsHeaderCellDef>
            {{ 'order.columnHeaders.type' | translate }}
          </mcs-header-cell>
          <mcs-data-cell *mcsDataCellDef="let row">
            <span text-wrap>{{ getOderTypeById(row.typeId) }}</span>
          </mcs-data-cell>
        </ng-container>

        <!-- Description Column -->
        <ng-container mcsColumnDef="description">
          <mcs-header-cell *mcsHeaderCellDef>
            {{ 'order.columnHeaders.description' | translate }}
          </mcs-header-cell>
          <mcs-data-cell *mcsDataCellDef="let row">
            <span text-wrap>{{ row.description }}</span>
          </mcs-data-cell>
        </ng-container>

        <!-- Status Column -->
        <ng-container mcsColumnDef="status">
          <mcs-header-cell *mcsHeaderCellDef>
            {{ 'order.columnHeaders.status' | translate }}
          </mcs-header-cell>
          <mcs-data-cell *mcsDataCellDef="let row">
            {{ row.statusLabel }}
          </mcs-data-cell>
        </ng-container>

        <!-- One-off Charge Column -->
        <ng-container mcsColumnDef="oneOffCharge">
          <mcs-header-cell *mcsHeaderCellDef>
            {{ 'order.columnHeaders.oneOffCharge' | translate }}
          </mcs-header-cell>
          <mcs-data-cell *mcsDataCellDef="let row">
            {{ row.charges?.currencySymbol }} {{ row.charges?.oneOff }}
          </mcs-data-cell>
        </ng-container>

        <!-- Monthly Charge Column -->
        <ng-container mcsColumnDef="monthlyCharge">
          <mcs-header-cell *mcsHeaderCellDef>
            {{ 'order.columnHeaders.monthlyCharge' | translate }}
          </mcs-header-cell>
          <mcs-data-cell *mcsDataCellDef="let row">
            {{ row.charges?.currencySymbol }} {{ row.charges?.monthly }}
          </mcs-data-cell>
        </ng-container>

        <!-- Data Status Integration -->
        <ng-container mcsDataStatusDef>
          <mcs-data-empty *mcsDataEmptyDef>
            <span>{{ 'order.noOrderItems' | translate }}</span>
          </mcs-data-empty>
          <mcs-data-error *mcsDataErrorDef>
            <span>{{ 'order.errorOnOrderItems' | translate }}</span>
          </mcs-data-error>
        </ng-container>

        <!-- Header and Data row -->
        <mcs-header-row *mcsHeaderRowDef="orderItemsColumns"></mcs-header-row>
        <mcs-data-row *mcsDataRowDef="let row; columns: orderItemsColumns;"></mcs-data-row>
      </mcs-table>
    </ng-container>
  </mcs-content-panel>
</mcs-page>