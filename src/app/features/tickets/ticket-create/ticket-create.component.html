<mcs-page [header]="textContent.header">
  <!-- Top Panel -->
  <mcs-top-panel *mcsTopPanelDef>
    <!-- Server Creation -->
    <mcs-top-panel-item *mcsTopPanelItemDef>
      <div class="action-item right-align" cursor="pointer" (click)="gotoTickets()">
        <mcs-icon [key]="backIconKey" size="large"></mcs-icon>
        <span>{{ textContent.backToTickets }}</span>
      </div>
    </mcs-top-panel-item>
  </mcs-top-panel>

  <!-- Content Panel -->
  <mcs-content-panel *mcsContentPanelDef>
    <div class="contextual-help-page-wrapper">
      <!-- Create ticket details -->
      <div class="page-information-wrapper ticket-create-information limited-view">
        <p [innerHTML]="textContent.description"></p>

        <form [formGroup]="fgCreateTicket" class="create-ticket-form">

          <!-- Ticket Type -->
          <div class="field">
            <label class="label" for="type">*{{ textContent.type }}</label>
            <div class="item">
              <mcs-select id="type" formControlName="fcType"
                placeholder="Ticket Type"
                [mcsContextualHelp]="contextualContent.type">
                <mcs-select-group header="Ticket Type">
                  <mcs-select-item *ngFor="let ticketType of ticketTypeList" [value]="ticketType.value">
                    {{ ticketType.text }}
                  </mcs-select-item>
                </mcs-select-group>
              </mcs-select>
              <mcs-validation-message [control]="fcType"></mcs-validation-message>
            </div>
          </div>

          <!-- Headline -->
          <div class="field">
            <label class="label" for="headline">
              *{{ convertHeadlineText(textContent.headline) }}
            </label>
            <div class="item">
              <mcs-textbox id="headline" width="100%" placeholder="Enter headline"
                formControlName="fcHeadline"
                [mcsContextualHelp]="contextualContent.headline"
                [valid]="isControlValid(fcHeadline)"></mcs-textbox>
                <mcs-validation-message [control]="fcHeadline"></mcs-validation-message>
            </div>
          </div>

          <!-- Details -->
          <div class="field">
            <label class="label" for="details">
              *{{ convertDetailsText(textContent.details) }}
            </label>
            <div class="item">
              <textarea id="details" rows="3" placeholder="Enter details"
                formControlName="fcDetails" class="full-width"
                [mcsContextualHelp]="contextualContent.details"></textarea>
              <mcs-validation-message [control]="fcDetails"></mcs-validation-message>
            </div>
          </div>

          <!-- Services -->
          <div class="field">
            <label class="label" for="services">{{ textContent.services }}</label>
            <div class="item">
              <div class="service-item">
                <mcs-textbox id="services" width="100%"
                  formControlName="fcService"
                  [mcsContextualHelp]="contextualContent.services"
                  [valid]="isControlValid(fcService)"></mcs-textbox>
                <div class="service-icon">
                  <mcs-icon [key]="servicesIconKey" size="large"
                    [mcsLoader]="servicesSubscription"
                    (click)="openServices()"></mcs-icon>
                </div>
              </div>

              <ng-container *ngIf="isServicesOpen">
                <mcs-ticket-service [services]="services"
                  (selectionChanged)="serviceItemSelectionChanged($event)"></mcs-ticket-service>
              </ng-container>
            </div>
          </div>

          <!-- Attachments -->
          <div class="field">
            <h4>{{ textContent.attachments }}</h4>
            <mcs-attachment attachedLimit="multiple"
              [allowedMimeType]="['image/jpeg', 'image/png', 'image/bmp', 'text/plain']"
              (attachedFilesChanged)="onChangedAttachments($event)"
              [mcsContextualHelp]="contextualContent.attachments">
            </mcs-attachment>
          </div>

          <!-- Ticket Action -->
          <div class="basic-action-bar">
            <a (click)="gotoTickets()">{{ textContent.cancelActivity }}</a>

            <mcs-button
              icon="arrow"
              (onClick)="onLogTicket()"
              [mcsLoader]="createTicketSubscription">
              {{ textContent.newTicket }}
            </mcs-button>
          </div>
        </form>
      </div>

      <!-- Create ticket contextual help -->
      <div class="contextual-information-wrapper">
        <mcs-contextual-help
          [contextualInformations]="contextualHelp"></mcs-contextual-help>
      </div>
    </div>
  </mcs-content-panel>
</mcs-page>