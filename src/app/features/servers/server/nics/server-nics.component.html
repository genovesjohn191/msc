<div class="limited-view">
  <!-- Loader settings -->
  <div [mcsLoader]="serverResourceSubscription"
    [mcsLoaderHideElement]="nicsContent"
    [mcsLoaderText]="textContent.loading"
    mcsLoaderOrientation="top"></div>

  <div class="container-wrapper" #nicsContent>
    <h4 class="container-header">{{ textContent.title }}</h4>
    <p *ngIf="textContent.description">{{ textContent.description }}</p>

    <ng-container [ngSwitch]="nicMethodType">
      <div [@fadeIn] *ngSwitchCase="serverNicMethodTypeEnum.AddNic" class="block-items-large">
        <!-- NICs Table -->
        <mcs-data-status [dataStatusFactory]="dataStatusFactory">
          <mcs-data-status-success mcsDataSuccess>
            <table class="basic-table no-gutter">
              <thead>
                <tr>
                  <th class="hidden-small">{{ textContent.nic }}</th>
                  <th>{{ textContent.network }}</th>
                  <th>{{ textContent.primary }}</th>
                  <th class="hidden-small">{{ textContent.ipMode }}</th>
                  <th>{{ textContent.ipAddresses }}</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let nic of serverNics">
                  <td class="hidden-small">
                    <ng-container *ngIf="nicIsInProgress(nic); else nicIndex">
                      <mcs-icon [key]="spinnerIconKey" size="small"
                        [mcsTooltip]="jobSummaryInfo"
                        mcsTooltipPosition="right"></mcs-icon>
                    </ng-container>
                    <ng-template #nicIndex>
                      <span>{{ nic.index }}</span>
                    </ng-template>
                  </td>
                  <td>
                    <span class="break-word-all"
                      [innerHTML]="nic.logicalNetworkName | mcsDataLabel">
                    </span>
                  </td>
                  <td>
                    <mcs-icon *ngIf="nic.isPrimary" class="space-left-medium"
                      [key]="checkIconKey" size="small"></mcs-icon>
                  </td>
                  <td class="hidden-small">
                    <span [innerHTML]="nic.ipAllocationModeLabel | mcsDataLabel"></span>
                  </td>
                  <td>
                    <mcs-list spacing="none">
                      <mcs-list-item *ngFor="let ipAddress of nic.ipAddresses">
                        <span [innerHTML]="ipAddress | mcsDataLabel"></span>
                      </mcs-list-item>
                    </mcs-list>
                  </td>
                  <td>
                    <div *mcsAccessControl="['VmNicEdit']" class="inline-items-small flex-nowrap">
                      <span *mcsIsSelfManagedServer="server">
                        <a [disabled]="!server.executable" (click)="openEditNicWindow(nic)"
                            mcsEventTracker="edit-nic"
                            mcsEventCategory="server"
                            mcsEventLabel="server-details-page">
                          {{ textContent.editLink }}
                        </a>
                      </span>
                      <span>
                        <a *ngIf="!nic.isPrimary"
                          [disabled]="!server.executable" (click)="deleteNic(nic)"
                          mcsEventTracker="delete-nic"
                          mcsEventCategory="server"
                          mcsEventLabel="server-details-page">
                          {{ textContent.deleteLink }}
                        </a>
                      </span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </mcs-data-status-success>

          <mcs-data-status-in-progress mcsDataInProgress>
            <span>{{ textContent.loadingContent }}</span>
          </mcs-data-status-in-progress>

          <mcs-data-status-empty mcsDataEmpty>
            <span>{{ textContent.noNics }}</span>
          </mcs-data-status-empty>

          <mcs-data-status-error mcsDataError>
            <span>{{ textContent.errorGettingNics }}</span>
          </mcs-data-status-error>
        </mcs-data-status>

        <!-- Adding NIC -->
        <ng-container *mcsAccessControl="['VmNicEdit']">
          <div class="action-box" *ngIf="addNicEnabled" [disabled]="!server.executable">
            <mcs-server-manage-network *ngFor="let item of manageNetworkTemplate"
              [resourceId]="serverResource?.id"
              [networks]="resourceNetworks"
              (dataChange)="onNetworkChanged($event)"
              [(selectedNetwork)]="selectedNetwork">

              <ng-container mcsManageNetworkHeader>
                <h4>{{ textContent.addHeading }}</h4>
              </ng-container>

              <ng-container mcsManageNetworkWarning>
                <mcs-data-status-warning>
                  {{ textContent.warningEditingNic }}
                </mcs-data-status-warning>
              </ng-container>
            </mcs-server-manage-network>

            <div class="action-items">
              <button mcsButton
                id="ctaAddServerNetwork"
                arrow="right" size="small"
                [disabled]="!inputIsValid"
                (click)="addNic()"
                mcsEventTracker="add-nic"
                mcsEventCategory="server"
                mcsEventLabel="server-details-page">
                {{ textContent.addButton }}
              </button>
            </div>
          </div>

          <mcs-data-status-warning *ngIf="hasReachedNicsLimit">
            <span>{{ textContent.reachedNetworksLimit }}</span>
          </mcs-data-status-warning>
        </ng-container>
      </div>

      <!-- Edit NIC -->
      <div [@fadeIn] *ngSwitchCase="serverNicMethodTypeEnum.EditNic" class="block-items-large">
        <div class="action-box" [disabled]="!server.executable">
          <mcs-server-manage-network
            [networks]="resourceNetworks"
            [resourceId]="serverResource?.id"
            (dataChange)="onNetworkChanged($event)"
            [customIpAddress]="currentIpAddress"
            [(selectedNetwork)]="selectedNetwork">

            <ng-container mcsManageNetworkHeader>
              <h4>{{ textContent.editHeading }} {{ selectedNic.index }}</h4>
            </ng-container>

            <ng-container mcsManageNetworkWarning>
              <mcs-data-status-warning>
                {{ textContent.warningEditingNic }}
              </mcs-data-status-warning>
            </ng-container>
          </mcs-server-manage-network>

          <div class="action-items">
            <a (click)="closeEditNicWindow()"
              mcsEventTracker="update-nic-close"
              mcsEventCategory="server"
              mcsEventLabel="server-details-page">Cancel</a>
            <button *mcsAccessControl="['VmEdit']"
              mcsButton id="ctaUpdateServerNetwork" arrow="right" size="small"
              [disabled]="!editNicEnabled" (click)="updateNic()"
                mcsEventTracker="update-nic"
                mcsEventCategory="server"
                mcsEventLabel="server-details-page">
              {{ textContent.updateButton }}
            </button>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</div>