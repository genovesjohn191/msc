<mcs-page [header]="'serverCreate.header' | translate">
  <!-- Top Panel -->
  <mcs-top-panel *mcsTopPanelDef>

    <!-- Back to Servers -->
    <mcs-top-panel-item *mcsTopPanelItemDef no-border>
      <mcs-action-item mcsAlign="end" mcsId
        (click)="gotoServers()"
        mcsEventTracker="back-to-server-listing"
        mcsEventCategory="server"
        mcsEventLabel="create-new-server-page">
        <mcs-icon [key]="backIconKey" size="large"></mcs-icon>
        <span>{{ 'serverCreate.backToServers' | translate }}</span>
      </mcs-action-item>
    </mcs-top-panel-item>
  </mcs-top-panel>

  <!-- Content Panel -->
  <mcs-content-panel *mcsContentPanelDef>

    <mcs-wizard [header]="'serverCreate.header' | translate">

      <!-- Server Details Step-->
      <mcs-wizard-step
        [stepTitle]="'serverCreateDetailsStep.title' | translate"
        [stepControl]="faCreationForm">

        <div class="limited-view">
          <div class="contextual-help-page-wrapper">
            <mcs-form-field>
              <mcs-select placeholder="Select a VDC" required
                mcsId="select-resource"
                (change)="onChangeResource($event)"
                [mcsContextualHelp]="'serverCreate.vdcDropdownList.helpText' | translate">

                <mcs-option-group>
                  <ng-container *mcsOptionGroupHeader>
                    {{ 'serverCreate.vdcDropdownList.header' | translate }}
                  </ng-container>

                  <mcs-option [value]="item" *ngFor="let item of resources$ | async">
                    {{ getResourceDisplayedText(item) }}
                  </mcs-option>
                </mcs-option-group>
              </mcs-select>
            </mcs-form-field>

            <mcs-server-create-details></mcs-server-create-details>
          </div>
        </div>
      </mcs-wizard-step>

      <ng-container *ngIf="resource$ | async as resource">
        <!-- Add-ons Step -->
        <mcs-wizard-step *ngIf="resource?.serviceType === serviceTypeEnum.Managed"
          [stepTitle]="'serverCreateAddOnsStep.title' | translate">
          <mcs-server-create-addons></mcs-server-create-addons>
        </mcs-wizard-step>

        <!-- Confirm Step  -->
        <mcs-wizard-step *ngIf="resource?.serviceType === serviceTypeEnum.Managed"
          [stepTitle]="'serverCreateConfirmStep.title' | translate">
          <mcs-server-create-confirm></mcs-server-create-confirm>
        </mcs-wizard-step>
      </ng-container>

      <!-- Go! Step  -->
      <mcs-wizard-step [stepTitle]="'serverCreateProvisioningStep.title' | translate">
        <mcs-server-create-provisioning></mcs-server-create-provisioning>
      </mcs-wizard-step>
    </mcs-wizard>

    <!-- Quote Widget -->
    <ng-container *ngIf="(resource$ | async)?.serviceType === serviceTypeEnum.Managed">
      <mcs-quote-widget *ngIf="order$ | async as orderDetails">

        <!-- Order Header -->
        <ng-container mcsQuoteWidgetHeader *ngIf="(orderIsUpdating$ | async); else actualPrice">
          <mcs-item>
            <mcs-loader></mcs-loader>
            <span>Updating charges</span>
          </mcs-item>
        </ng-container>
        <ng-template #actualPrice>
          <span>Total Cost: ${{ getTotalOrderCost(orderDetails) }}</span>
        </ng-template>

        <!-- Order Content -->
        <mcs-item orientation="separated">
          <span>Monthly</span>
          <span>${{ orderDetails.charges?.monthly || 0 }}</span>
        </mcs-item>
        <mcs-item orientation="separated">
          <span>One-Off</span>
          <span>${{ orderDetails.charges?.oneOff || 0 }}</span>
        </mcs-item>
      </mcs-quote-widget>
    </ng-container>

  </mcs-content-panel>
</mcs-page>