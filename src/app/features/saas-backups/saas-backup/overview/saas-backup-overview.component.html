<ng-container *ngIf=" selectedSaasBackup$ | async as selectedSaasBackup">
  <mcs-grid-row>
    <!-- Overview -->
    <mcs-grid-column sizeSm="12">
      <mcs-presentation-panel mcsId="saas-backup-overview">
        <ng-container mcsPresentationPanelHeader>
          <h2>{{ 'label.overview' | translate }}</h2>
        </ng-container>

        <mcs-item>
          <span>{{ 'saasBackup.overview.description' | translate }}:</span>
          <span>{{ selectedSaasBackup.billingDescription }}</span>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.overview.serviceId' | translate }}:</span>
          <ng-container *ngIf="selectedSaasBackup.serviceId; else noServiceIdTemplate">
            <span>{{ selectedSaasBackup.serviceId }}</span>
          </ng-container>
          <ng-template #noServiceIdTemplate>
            <mcs-data-status-empty
              [mcsTooltip]="'label.ticketingOrderingUnavailable' | translate"
              [mcsTooltipShow]="!selectedSaasBackup.serviceId">
              {{ 'label.unknown' | translate }}
            </mcs-data-status-empty>
          </ng-template>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.overview.tenant' | translate }}:</span>
          <span>{{ selectedSaasBackup.tenantName }}</span>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.overview.domain' | translate }}:</span>
          <span>{{ selectedSaasBackup.tenantDomain }}</span>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.overview.type' | translate }}:</span>
          <span>{{ selectedSaasBackup.typeLabel }}</span>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.overview.totalLicensedUsers' | translate }}:</span>
          <span>{{ selectedSaasBackup.licensedUserQuantity }}</span>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.overview.totalUnlicensedUsers' | translate }}:</span>
          <span>{{ selectedSaasBackup.unlicensedUserQuantity }}</span>
        </mcs-item>
      </mcs-presentation-panel>
    </mcs-grid-column>

    <!-- Backup Statistics -->
    <mcs-grid-column *ngIf="selectedSaasBackup?.lastBackupAttempt | mcsIsNotNullOrEmpty"
      sizeSm="12" hidden-small>
      <mcs-presentation-panel mcsId="saas-backup-backup-statistics">
        <ng-container mcsPresentationPanelHeader>
          <h2>{{ 'label.backupStatistics' | translate }}</h2>
        </ng-container>

        <mcs-item>
          <mcs-icon [key]="selectedSaasBackup.lastBackupAttempt.backupStatusStateIconKey" size="small"></mcs-icon>
          <span>{{ selectedSaasBackup.lastBackupAttempt.getStatusLabel }}</span>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.backupStatistics.firstBackupTime' | translate }}:</span>
          <ng-container *ngIf="selectedSaasBackup.lastBackupAttempt.startTime | mcsIsNotNullOrEmpty; else emptyDateTemplate">
            <span [innerHTML]="selectedSaasBackup.lastBackupAttempt.startTime | mcsStdDateFormat"></span>
          </ng-container>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.backupStatistics.lastBackupTime' | translate }}:</span>
          <ng-container *ngIf="selectedSaasBackup.lastBackupAttempt.endTime | mcsIsNotNullOrEmpty; else emptyDateTemplate">
            <span [innerHTML]="selectedSaasBackup.lastBackupAttempt.endTime | mcsStdDateFormat"></span>
          </ng-container>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.backupStatistics.failedToBackupInLastAttempt' | translate }}:</span>
          <span>{{ selectedSaasBackup.lastBackupAttempt.failedUsers || 0 }}</span>
        </mcs-item>
        <mcs-item>
          <span>{{ 'saasBackup.backupStatistics.succesfullyBackupInLastAttempt' | translate }}:</span>
          <span>{{ selectedSaasBackup.lastBackupAttempt.successfulUsers || 0 }}</span>
        </mcs-item>
      </mcs-presentation-panel>
    </mcs-grid-column>
  </mcs-grid-row>
  <ng-template #emptyDateTemplate>
    <span> {{ 'label.none' | translate }}</span>
  </ng-template>

  <mcs-grid-row>
    <!-- Backup Components -->
    <mcs-grid-column *ngIf="selectedSaasBackup?.componentOnlineStatus | mcsIsNotNullOrEmpty"
      sizeSm="12" hidden-small>
      <mcs-presentation-panel mcsId="saas-backup-backup-statistics">
        <ng-container mcsPresentationPanelHeader>
          <h2>{{ 'label.backupStatistics' | translate }}</h2>
        </ng-container>

        <mcs-item>
          <mcs-icon [key]="selectedSaasBackup.componentOnlineStatus.exchangeStateIconKey" size="small"></mcs-icon>
          <span>{{ 'saasBackup.backupComponents.exchange' | translate }}</span>
        </mcs-item>
        <mcs-item>
          <mcs-icon [key]="selectedSaasBackup.componentOnlineStatus.sharePointStateIconKey" size="small"></mcs-icon>
          <span>{{ 'saasBackup.backupComponents.sharePoint' | translate }}</span>
        </mcs-item>
        <mcs-item>
          <mcs-icon [key]="selectedSaasBackup.componentOnlineStatus.teamsStateIconKey" size="small"></mcs-icon>
          <span>{{ 'saasBackup.backupComponents.teams' | translate }}</span>
        </mcs-item>
        <mcs-item>
          <mcs-icon [key]="selectedSaasBackup.componentOnlineStatus.teamsChatsStateIconKey" size="small"></mcs-icon>
          <span>{{ 'saasBackup.backupComponents.teamsChats' | translate }}</span>
        </mcs-item>
      </mcs-presentation-panel>
    </mcs-grid-column>
    <mcs-grid-column sizeSm="12" hidden-small>
    </mcs-grid-column>
  </mcs-grid-row>
</ng-container>
