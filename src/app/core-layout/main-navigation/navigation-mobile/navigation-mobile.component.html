<!-- Products Mega Menu Pop-over -->
<ng-template #productMegaMenuTemplate>
  <div class="product-megamenu-mobile-wrapper" scrollable>
    <mcs-accordion [multi]="true">
      <mcs-accordion-panel *ngFor="let catalog of productCatalogs">
        <mcs-accordion-panel-header mcsPanelHeaderDef>
          {{ catalog.name }}
        </mcs-accordion-panel-header>

        <div class="block-items-medium bordered">
          <mcs-list [header]="category.name" itemsOffset="small"
            *ngFor="let category of catalog.categories">
            <mcs-list-item *ngFor="let product of category.products">
              <a (click)="gotoProduct(product)">{{ product.name }}</a>
            </mcs-list-item>
          </mcs-list>
        </div>
      </mcs-accordion-panel>
    </mcs-accordion>
  </div>
</ng-template>

<!-- Main navigation for mobile -->
<div class="navigation-mobile-wrapper">
  <div class="navigation-mobile-icon">
    <mcs-icon [key]="toggleIconKey" size="large" (click)="open()"></mcs-icon>
  </div>

  <!-- Macquarie Link View -->
  <div class="macquarie-link">
    <ng-container *ngIf="productCatalogFeatureIsOn; else macquarieViewTemplate">
      <a class="inline-items-xsmall" mcsPopover maxWidth="auto"
        [content]="productMegaMenuTemplate"
        theme="light" priority="high"
        placement="bottom" orientation="left"
        [placementElement]="caretIconElement">

        <span>{{ textContent.productCatalog }}</span>
        <span #caretIconElement>
          <mcs-icon [key]="caretDownIconKey"
            size="medium" color="white"></mcs-icon>
        </span>
      </a>
    </ng-container>

    <ng-template #macquarieViewTemplate>
      <a [href]="macquarieViewUrl" target="_blank" class="inline-items-xsmall">
        <mcs-icon [key]="arrowUpIconKey" size="large"></mcs-icon>
        <span>{{ textContent.macquarieView }}</span>
      </a>
    </ng-template>
  </div>
</div>

<!-- Navigation list from template binding -->
<div #navigationList class="navigation-mobile-list"
  animate [trigger]="slideTrigger" style="display: none;"
  scrollable="dark" scrollbarSize="small">

  <!-- Title -->
  <div class="navigation-mobile-item navigation-mobile-title">
    <h3>{{ textContent.title }}</h3>
    <mcs-icon [key]="closeIconKey" color="white"
      cursor="pointer" (click)="close()"></mcs-icon>
  </div>

  <!-- Navigation items -->
  <ng-content></ng-content>

  <!-- Logout Item -->
  <div class="navigation-item">
    <mcs-icon [key]="caretRightIconKey" color="white"></mcs-icon>
    <a cursor="pointer" (click)="logout($event)">{{ textContent.signOut }}</a>
  </div>

  <!-- Account panel Item -->
  <div *mcsAccessControl="['CompanyView']"
    class="navigation-mobile-item navigation-account-panel-wrapper" >
    <div class="user-account-trigger">
      <div class="labelled-icon" display-flex justify-content="space-between"
        cursor="pointer" (click)="toggleAccountPanel()">
        <a class="user-name text-light">{{ firstName }} {{ lastName }}</a>
        <mcs-icon [@indicatorIcon]="switchAccountAnimation"
          [key]="caretDownIconKey" color="white"></mcs-icon>
      </div>
      <small read-only>{{ activeAccount?.name }}</small>
    </div>
    <div [@bodyExpansion]="switchAccountAnimation" class="switch-account-panel">
      <div class="account-details">
        <mcs-account-panel></mcs-account-panel>
      </div>

      <div class="switch-account-details">
        <mcs-switch-account (selectionChanged)="close()"></mcs-switch-account>
      </div>
    </div>
  </div>
</div>