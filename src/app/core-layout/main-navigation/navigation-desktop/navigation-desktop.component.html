<!-- Products Mega Menu Pop-over -->
<ng-template #productMegaMenuTemplate>
  <div class="product-megamenu-wrapper" mcsScrollable>
    <mcs-data-status [dataStatusFactory]="productsStatusFactory">
      <mcs-data-status-success mcsDataSuccess>
        <ng-container *mcsAccessControl="[]; feature: EnableProductCatalog">
          <mcs-grid *ngIf="selectedProduct$ | async as selectedProduct">
            <mcs-grid-row>
              <ng-container *ngFor="let catalog of productCatalogs; last as isLastItem">
                <mcs-grid-column >
                  <mcs-presentation-panel>
                    <ng-container mcsPresentationPanelHeader>
                      <h2>{{ catalog.name }}</h2>
                    </ng-container>

                    <mcs-section>
                      <mcs-list [header]="category.name"
                        *ngFor="let category of catalog.categories">
                        <mcs-list-item *ngFor="let product of category.products">

                          <a mcsButton="basic"
                            labelPlacement="left" text-wrap full-width
                            [active]="selectedProduct?.id === product.id"
                            [mcsRouterLink]="[routeKeyEnum.ProductDetail, product.id]"
                            (click)="gotoProduct(product)"
                            mcsId="select-product"
                            mcsEventTracker="select-product"
                            mcsEventCategory="navigation"
                            mcsEventLabel="main-nav">
                            {{ product.name }}</a>

                        </mcs-list-item>
                      </mcs-list>
                    </mcs-section>
                  </mcs-presentation-panel>
                </mcs-grid-column>
                <mcs-divider *ngIf="!isLastItem" orientation="vertical"></mcs-divider>
              </ng-container>
            </mcs-grid-row>
          </mcs-grid>
        </ng-container>
      </mcs-data-status-success>

      <mcs-data-status-in-progress mcsDataInProgress>
        <span>{{ textContent.loadingProducts }}</span>
      </mcs-data-status-in-progress>

      <mcs-data-status-empty mcsDataEmpty>
        <span>{{ textContent.noProducts }}</span>
      </mcs-data-status-empty>

      <mcs-data-status-error mcsDataError>
        <span>{{ textContent.errorProducts }}</span>
      </mcs-data-status-error>
    </mcs-data-status>
  </div>
</ng-template>

<!-- Main navigation for desktop/tablet -->
<div class="navigation-desktop-wrapper">

  <!-- Navigation list from template binding -->
  <ng-content></ng-content>

  <!-- Macquarie Link View -->
  <div class="macquarie-link">
    <ng-container *ngIf="productCatalogFeatureIsOn; else macquarieViewTemplate">
      <a mcsPopover maxWidth="auto"
        [content]="productMegaMenuTemplate"
        theme="light" priority="high"
        placement="bottom" orientation="left"
        [placementElement]="caretIconElement">

        <mcs-item>
          <span>{{ textContent.productCatalog }}</span>
          <span #caretIconElement>
            <mcs-icon [key]="caretDownIconKey"
              size="medium" color="white"></mcs-icon>
          </span>
        </mcs-item>
      </a>
    </ng-container>

    <ng-template #macquarieViewTemplate>
      <a [href]="macviewUrl" target="_blank"
        mcsId="macquarie-view"
        mcsEventTracker="macquarie-view"
        mcsEventCategory="navigation"
        mcsEventLabel="main-nav">
        <mcs-item>
          <mcs-icon [key]="arrowUpIconKey" size="large"></mcs-icon>
          <span>{{ textContent.macquarieView }}</span>
        </mcs-item>
      </a>
    </ng-template>
  </div>
</div>